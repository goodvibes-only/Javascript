

<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<title>Form handling with JavaScript</title>
<script>
function updateAll(){
	var prices = document.querySelectorAll('tr>td:nth-child(2)');
	var plength = prices.length-1;
	
	var n = new Array(plength); //수량
	var price = new Array(plength); //가격
	var p  = new Array(plength); // 수량 * 가격
	var totalNumber= 0; //총 수량
	var totalPrice = 0; // 총 합계
	
	for (var i = 0; i < plength; i++){
		var id ="book" + (i + 1); //수량의 id를 구하니다.
		n[i] = document.getElementById(id).value; //수량값을 배열 n에 저장합니다.
		price[i] = prices[i].textContent.replace(/,|원/g,""); //가격
		p[i] = parseInt(price[i]) * parseInt(n[i]);
		document.getElementById("book" + (i + 1) + "Total").value = p[i].toLocaleString();
		totalNumber += parseInt(n[i]);
		totalPrice += parseInt(p[i]);
	}
	
	document.getElementById("totalNumber").value = totalNumber.toLocaleString();
	document.getElementById("totalPrice").value = totalPrice.toLocaleString();

}
</script>
</head>
<body>
	<h2>서적 주문 양식</h2>
	<form action="ex0201_domtree.html" method = "get" oninput = "updateAll();">
		<table border="1">
		
			<tr>
				<th>책 제목</th>
				<th>가격</th>
				<th>수량</th>
				<th>합계</th>
			</tr>
			<tr>
				<td>4차 산업</td>
				<td>25,000원</td>
				<td><input id="book1" type="text" size="2" value="0"
					onclick="this.select();"></td>
					<!-- 이벤트 핸들러를 직접 기술하여 등록방식
					     this.select()는 각 서적 수량을 표시하는 텍스트 박스를 클릭하면 그 값이 선택되도록 하는 기능을 갖는다.
					     this는 <input>요소의 DOM을 가리키게 된다. 즉, 자신이 속한 DOM을 가리키는 것이다.-->
				<td><input id="book1Total" type="text" size="6" value="0" > 원</td>
			</tr>
			<tr>
				<td>다이어트</td>
				<td>27,000원</td>
				<td><input id="book2" type="text" size="2" value="0"
					onclick="this.select();"></td>
				<td><input id="book2Total" type="text" size="6" value="0" > 원</td>
			</tr>
			<tr>
				<td>윤식당</td>
				<td>25,000원</td>
				<td><input id="book3" type="text" size="2" value="0"
					onclick="this.select();"></td>
				<td><input id="book3Total" type="text" size="6" value="0" > 원</td>
			</tr>
			<tr>
				<td>합계</td>
				<td>&nbsp;</td>
				<td><input id="totalNumber" type="text" size="2" value="0" ></td>
				<td><input id="totalPrice" type="text" size="6" value="0" > 원</td>
			</tr>
		</table>
		<br> <input type="button" value="합계계산" onclick="updateAll();" > <!-- 이벤트 핸들러 함수를 호출하는 방식 -->
		       <input type="reset" value="초기화" >
		       <input type="submit" value="제출" >
	</form>

</body>
</html>
